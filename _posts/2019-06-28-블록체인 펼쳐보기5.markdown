---
layout:     post
title:      블록체인 펼쳐보기 - 5
author:     bcnote3314
tags: 		blockchain 블록체인펼쳐보기
subtitle:  블록체인 정복기	
category: Block
---

# 블록체인 펼쳐보기 - Chapter 06(1)

블록체인 펼쳐보기 챕터 6에 대한 내용 정리 -1

## 비트코인 거래

비트코인의 거래는 블록체인에 어떻게 기록이 될까?
일반적인 화폐의 경우 700원짜리 아이스크림을 살때 1000원짜리 지폐를 낸다면 300원을 거슬러 받는다.
미리 정해진 가격의 화폐를 주고 받는 방식이다.

가상화폐는 다르다 정해진 액면가의 실물이 존재하는 것이 아니고 거래의 결과에 따라 새로운 액면가의 화폐가 생기고 사라진다. 

![거래1](http://drive.google.com/uc?export=view&id=1rxWt2r8Vqmuk8TWYaBQGTqXAW3KP_M0I)


1000원을 지불하는 것이 아니라 700원을 주고 300원이 남아있는 것이다.
(단순한 코딩이라고 생각해보면 이해가 쉽다. MyMoney -= 700, YourMoney += 700을하지 1000을 뺐다가 300을 더하는 형태로 코딩하지 않을꺼잖아???)

어떤 상황이든 위와 같은 형태이다. 만약 거래가 여러군데에서 발생해서 다수의 분리된 코인을 가지고 있다면?

![거래2](http://drive.google.com/uc?export=view&id=1rNIEu9pmqqZM3zVXKzNKgOKU7gM8Lbyx)

필요한 만큼의 코인중에 사용한 만큼만 전달되고 나머지는 새로운 잔돈 코인으로 남는 형태이다. (물론 건드리지 않은 코인에 대해서는 전혀 미동이 없다.)


## 거래기록

장부에는 실제 어떤 기록들이 들어가야 할까?

비트코인을 관리하기 위해선 화폐를 보관하는 지갑이나 잔고를 보관하는 통장계좌처럼 보관할 곳이 필요하다. 즉 보관을 위한 장소를 가리키는 주소값이 존재한다.
내 코인을 누군가에게 전달하기 위해서는 상대방의 주소값에다가 코인을 넘겨주었다는 거래 기록을 작성한다.

이런 거래기록에는 내가 사용하는 코인이 과거에 어느 거래를 통해서 내게 넘어온것지, 상대방의 목적지(주소), 지불금액, 거래가 일어난 후에 남은 잔액이 적히게 된다.

거래 전후의 상태를 입출력으로 보면 입력에는 내 코인이 내것이라는 증명이 들어간다. 물론 여러개의 코인을 사용해야 하는 경우 이런 증명이 여러 개 들어간다.
출력에는 상대방에게 지불된 코인과 나에게 남은 잔액을 작성한다.
즉 상대방 주 소값에 지불된 코인, 내 주소값에 잔액 코인이 새로 생성된다. (잔액을 작성안하면 어디로 갈지 모르니 반드시 작성되어야 한다.)

이런 거래장부는 사용자가 코인을 꺼내서 사용하는 것이기 때문에 사용자 측에서 전파를 시작해야한다.

입출력시에 코인의 주인이 나라는 증명과 목적지 주소값의 주인만 해당 코인을 사용할수 있다는것은 암호화를 통해서 보장한다.
이때 사용하는 방식을 비대칭키 암호화(공개키 기반구조 PKI) 이다.

## 비대칭키 암호화

암호 관련된 내용은 따로 공부할 필요성이 좀있다. (별도의 Post 로 작성)

일반적인 암호 방식은 대칭키 구조이다. 
암호를 거는 쪽과 푸는 쪽 모두 동일한 암호키를 사용한다. 즉 암호가 유출이 되면 모든 내용이 다 유출이 되는 구조이며, 이런 키를 관리하는것 또한 어렵다. (하지만 아직도 많이 사용하는 방식이다.)

비대칭키 암호화는 암호화와 복호화의 키가 다를뿐 아니라 계산량이 많기 때문에 한쪽을 알아도 다른 한쪽을 알아내기가 어렵다.

비대칭키는 개인키와 공개키 두가지를 한 쌍으로 구성하며, 개인키는 만든 사람만 알고 있는 것이고 공개키는 외부에 공개되어있는 것이다.

이때 한쪽의 키로 암호화를 하면 반드시 다른 하나의 키로 복호화가 가능하다.

![비대칭](http://drive.google.com/uc?export=view&id=1IwGUTcWJnwjxAedWfuIWwruTHs0Sqkb3)

## 비밀 메시지 전송과 디지털 서명

비밀 메세지를 전달 하는 방법은 간단하다.
받는사람의 공개키는 모든 사람들에게 알려진 내용이다. 즉 그 공개키로 암호화를 해서 던지면 공개키의 반대되는 즉 수신자의 개인키로만 암호화로만 풀수 있다.

반대의 경우엔 어떻게 될까?
내 비밀키로 암호화한 메세지는 내 공개키로만 복호화가 가능하다. 그 공개키는 모두가 알고 있다. 즉 나의 디지털 서명이 된다. 

예를들어 나는 x에게 10만원을 빌렸다. 라고 쓰고 내 비밀키로 암호화하면, 누구나 가진 내 공개키로 이 서명된 문서를 볼수 있다. 그리고 그 문서는 나만 작성가능한 것이기 때문에 추후에 거짓말을 하지 못한다.

이 디지털 서명은 비트코인에서 아주 직접적인 연관이 있다. 아까 장부에는 지불 했다는 서명과 받은사람만 사용할수 있도록 기록해야 한다고 했다.
즉 서명에는 내 비밀키로 암호화한 서명을 작성하고 받을 사람의 공개키로 암호화 하여 그사람만 사용할수 있도록 증명할수가 있다.


# 비대칭키 단점

비대칭키는 대칭키 방식에 비해 계산량이 많다는 단점이 있다.
대칭키의 경우는 양쪽이 같은 비밀키만 가지고 있기만 하다면 빠르게 메세지를 주고 받을수 있다. 다만 그 비밀키가 누설되면 더 이상 암호 메세지가 아니라는 단점이 있다.


