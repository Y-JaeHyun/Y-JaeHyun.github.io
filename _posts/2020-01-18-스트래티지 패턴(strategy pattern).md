---
layout:     post
title:      스트래티지 패턴(strategy pattern)
author:     bcnote3314
subtitle:  	디자인 패턴
tags: 		designpattern
category: Pattern
---

## 디자인 패턴

이미 선배 개발자들이 특정 문제에 대한 좋은 해결 방안들을 수도 없이 많이 만들어 왔다.  
그 해결 방안에는 많은 지혜와 교훈이 숨어 들어있다.  

안전성이 보장된 코드, 유지보수를 위하여 능동적으로 변화할수 있는 코드 그런 코드를 만들기 위해서는 좋은 코드를 많이 봐야한다.  
또 그속에 숨어있는 원칙을 보고 내 문제에 적용할수 있는 방법들을 고민하는 것, 나중에 활용 가능한 지식들을 뽑아내는 것이 목표이다.

## 상속, 인터페이스

상속이라는 개념이 C에는 없긴 하지만 상속이 코드 재사용을 위한 개념이란 점을 유념하면 비슷하게나마 사용할수 있지 않을까 싶다.

게임을 할때 캐릭터 라는 부모 클래스를 상속 받는 다양한 유저들의 실제 캐릭터들이 있을수 있다.  
유저들의 선택에따라 어떤 캐릭터는 칼로 베는 동작을 할수있고, 주먹으로 때릴수 있고, 활을 쏠수도 있다.

![캐릭터클래스](http://drive.google.com/uc?export=view&id=12KSyy_AoYuJJcM8LRl5g_qdm0z3wrEFP)

위 와같은 상속구조로 이루어져 있다면 이를 구현하기 위해서는 각 실제 클래스별로 함수를 오버라이드 해서 따로 구현을 해주어야 한다. 
클래스를 상속받는 것이 아니라 인터페스를 보는것도 역시 동일하다.  
구현체가 없기 때문에 각 클래스들에서 Attack 함수를 모두 구현해 주어야 한다.  
솔직히 나쁘다고 생각하지 않았고, Python을 통하여 비슷한 상황이 있었을때도 동일하게 구현했던적이 있다. ㅠㅠ  
(인터페이스는 보통 행동에 대한 부분을 정의하는 느낌으로 많이 사용하는 것 같다.)  

이 방식의 문제점은 나중에 클래스의 규격이나 구조가 변경된다면, Attack 함수의 동작이 변경된다면 매번 해당 클래스들의 Attack 함수들에 끼치는 영향에 대해서 검토를 해야한다.  
또한 각각 구현되어있기 때문에 나중에 구현된 Attack의 특정 부분에서 문제가 생겼을때 다른 Attack 클래스들을 같이 봐줘야한다.  
재사용의 관점에서는 영 의미가 없어지게 되는것이다.

## 스트래티지 패턴

> 애플리케이션에서 달라지는 부분을 찾아내고, 달라지지 않는 부분으로 부터 분리 시킨다.  

이 원칙은 스트래티지 패턴 외에도 모든 디자인 패턴의 기반을 이루는 원칙이다.  
변경되는 부분 (요구사항이나, 기능 추가 등등)을 따로 뽑아서 캡슐화 시켜서 변경되지 않는 부분에 영향을 주지 않도록 하는 것이다.

> 구현이 아닌 인터페이스에 맞춰서 프로그래밍 한다.

여기서 말하는 인터페이스는 자바의 interface에 국한된 것이 아니다.  
interface라는 개념을 지칭하는 것으로 상위 형식에 맞춰서 프로그래밍 하는것으로 다형성을 활용하라는 의미이다.

무언가 행동을 인터페이스로 정의하하여 활용하는 형태로 구현하는 것이다.  
이전에 Attack을 코드가 각각의 Character에 구현되어있던 방식에서 별도의 행도을 위한 인터페이스를 각 Character에서 사용하는 방식이 된다.

이렇게 되면 나중에 Attack의 동작이 변경하더라도 각 Character와는 분리되어 있기 때문에 그쪽은 다시 구현할 필요가 없다.  

![인터페이스](http://drive.google.com/uc?export=view&id=1pQqLaEoHSU4hEZmw6JFj0T2XAP_AR3ze)

> 상속보다 구성을 활용한다.

"A는 B이다.", "A에는 B가 있다"

행동을 상속을 받아 구현하는 방법이 있을수 있지만, 변수로 받아 사용할수도 있다.  
이런 방식을 구성(composition)이라고 한다.  
구성을 통해서 유연함을 크게 향상 시킬수 있다.  

![전체](http://drive.google.com/uc?export=view&id=1602H773--r86bgG2_kQ6COaFNuomtHXw)

## 느낀점

첫장은 디자인 패턴의 기본 원칙을 알려주면서 첫번째 패턴인 스트래티지 패턴을 알려줬다.  
스트래티지 패턴은 무언가 행동을 별도의 인터페이스로 구현하고 그 행동을 필요로 하는 객체에 해당 인터페이스를 구성요소로 활용하는 방법을 의미하는 느낌이다.  

실제 동작중에 이런 행동의 변화가 있는 케이스는 수도 없이 많다.  
회사 프로젝트에서 구현한 기능들 중에는 비슷하게 내부에 동작 과정이나 혹은 참조해야 하는 데이터 셋이 변경되는 경우가 자주 있고 이를 구현하기 위하여 다양한 방식을 통하여 구현한 것이 있다.

일부는 심지어 비슷한 느낌도 있다. (뭐 간단히 말하면 필요한 부분의 포인터를 가리키는 것으로 스위칭 하는 방식인데 이건 C를 쓰다보면 많이 겪을 일이긴한거 같기도하고..)
아무튼 회사 입사 이후 객체지향 요소를 상당히 많이 잊었는데, 오랜만에 보니 새롭게 다가오는 것같다.

[C로 표현해본 Strategy Pattern](https://github.com/y-jaehyun/designpatterns/tree/master/strategy)
