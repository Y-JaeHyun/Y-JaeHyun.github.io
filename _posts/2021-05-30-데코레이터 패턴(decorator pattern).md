---
layout:     post
title:      데코레이터 패턴(Decorator Pattern)
author:     bcnote3314
subtitle:  	디자인 패턴
tags: 		designpattern
category: Pattern
---


## 데코레이터 페턴(Decorator Pattern)

데코레이터 패턴은 원래의 클래스 코드는 전혀 바꾸지 않고 객체에 새로운 임무를 부여할수 있는 형태의 패턴이다.

데코레이터 패턴에서는 객체에 추가적인 요건을 동적으로 첨가한다.
데코레이터는 서브클래스를 만드는 것을 통해서 기능을 유연하게 확장할 수 있는 방법을 제공한다.

* 데코레이터의 수퍼클래스는 자신이 장식하고 있는 객체의 수퍼클래스와 같다.
* 한 객체를 여러개의 데코레이터로 감쌀 수 있다.
* 데코레이터는 자신이 감싸고 있는 객체와 같은 수퍼클래스를 가지고 있기 때문에 원래 객체가 들어갈 자리에 데코레이터 객체를 집어넣어도 상관이 없다.
* 데코레이터는 자신이 장식하고 있는 객체에게 어떤 행동을 위임하는 것 외에 원하는 추가적인 작업을 수행할 수 있다.
* 객체는 언제든지 감쌀 수 있기 때문에 실행중에 필요한 데코레이터를 마음대로 적용할 수 있다.

## 데코레이터 예시

책에서 제시하는 별다방 예제이다.

![별다방예시](http://drive.google.com/uc?export=view&id=1-QNWYMOLwZuyYysJZ31g3aukzW1x29BZ)

각 음료는 기본적인 가격을 고정해서 Beverage를 상속받아 구현한다.  
첨가물의 가격을 제외한 기본적인 가격만 적어둔다.  

그 외의 첨가물들은 데코레이터를 상속받아 Beverage 구성 요소로 두어 구현한다.

근데 왜 CondimentDecorator라는 별도의 클래스를 중간에 두었을까?
getDescrioption 함수를 별도의 추상 함수로 오버라이딩한 이후 각 첨가물에서 표현을 추가하기 위한 요소이다. (ex. +모카, +우유 등을 표현해야 하기 떄문에 해당 getDescrioption을 각 첨가물에서 구현을 강제시키기 위함이다.)

데코레이터 패턴은 구성 요소의 형식을 알아내서 특정 작업을 하는 코드에 대해서는 적절하지 않다.  
데코레이터에 의해 감싸고 나면 내부의 객체가 어떤 형태인지 알수가 없기 떄문이다.
즉 추상 구성요소 형식을 바탕으로 돌아가느나 코드에 대해서 데코레이터 패턴을 적용해야만 제대로된 결과가 나온다.


## 데코레이터 단점

데코레이터에 유명한 예시는 Java에서 구현된 I/O이다.

대학교 시절에 Java를 배울떄 항상 I/O를 사용하기 위해서 'new BufferedReader(new FileReader())'의 형태로 객체를 생성 했던 적이 있다.
뭔진 잘 모르고 그냥 사용했었는데 이것이 데코레이터를 이용한 예시이다.

BufferedReader 외에도 많은 데코레이터들을 이용해서 기능을 추가할수 있다. (BufferedReader는 속도향상을 위한 버퍼 처리 기능과 한줄씩 읽기 처리해주는 readLine함수 구현된 것을 추가해준다.)

하지만 Java I/O도 그렇듯 유연하게 기능이 추가 되는 장점은 있지만 그만큼 자잘한 클래스들이 계속 늘어나서 이해하기 어렵게 복잡해지는 경우가 많다.

또한 그 외에도 특정 형식에 의존하는 코드에 적용하면 안된다는 점, 구성요소를 초기화 하는데 코드가 복잡해진다는 단점이 있다.

단 이러한 단점은 팩토리 패턴과 같은 다른 패턴에 의하여 보완 될수는 있다.

## Open-Closed Principle(OCP) 원칙

> 클래스는 확장에 대해서는 열려있어야 하지만 코드 변경에 대해서는 닫혀있어야 한다.

OCP 원칙은 옵저버 패턴 등을 보면 이미 다양한 형태로 사용되고 있다.  
다만 이것을 모든 코드에 적용하는 것은 많은 시간과 노력이 필요한 부분이다.  
또한 이 원칙을 고수할만큼의 영향도가 없거나, 그럴만한 시간이 없는 경우도 많다.

반대로 OCP를 지키기 위해 코드의 복잡성이 심해지는 경우가 생길수 있기 때문에 코드내에서 바뀔 확률이 높고 중요한 부분을 중점적으로 원칙을 적용하는 것이 현명한 방법이다.

상당한 주의가 필요한 부분임을 명심해야한다.


## @ 예약어

Python 에는 데코레이터 페턴을 미리 구현해둔 예약어가 있다. (java나 다른곳에서도 본거같다..)  
'@'로 사용 가능하며 관련 내용은 아래 링크에서 사용방법등이 확인 가능하다. 


[Python Decorator](https://bcnote3314.github.io/note/2021/05/30/Python-Decorator/)